<!DOCTYPE html>
<html lang="en" id="htmlRoot" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Teacher Shirley's ET Platform</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700;900&family=Exo+2:wght@300;400;500;700&family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:ital,wght@1,400;1,600&display=swap" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸª</text></svg>">
  
  <style id="themeStyles">
    :root {
      /* --- Light Mode --- */
      --bg-gradient: linear-gradient(to bottom, #fdfbfb 0%, #f4f7f6 100%);
      --surface: rgba(255, 255, 255, 0.85);
      --glass: rgba(255, 255, 255, 0.6);
      --border: rgba(0, 0, 0, 0.08);
      --text: #2c3e50; 
      --text-light: #7f8c8d;
      --accent: #2980b9; 
      --accent-glow: rgba(41, 128, 185, 0.3);
      --card-shadow: 0 10px 25px rgba(0,0,0,0.05);
      --sun-color: #f39c12; --moon-color: #95a5a6; --planet-color: #3498db;
    }

    .dark {
      /* --- Dark Mode --- */
      --bg-gradient: radial-gradient(circle at 50% 20%, #1a253a 0%, #0f1219 100%);
      --surface: rgba(30, 35, 50, 0.7);
      --glass: rgba(30, 35, 50, 0.4);
      --border: rgba(255, 255, 255, 0.1);
      --text: #ecf0f1;
      --text-light: #bdc3c7;
      --accent: #f1c40f; 
      --accent-glow: rgba(241, 196, 15, 0.4);
      --card-shadow: 0 10px 30px rgba(0,0,0,0.4);
      --sun-color: #f1c40f; --moon-color: #dfe6e9; --planet-color: #00d2ff;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: var(--bg-gradient);
      background-attachment: fixed;
      color: var(--text);
      font-family: 'Exo 2', 'Noto Sans TC', sans-serif;
      line-height: 1.7;
      transition: color 0.3s, background 0.3s;
      min-height: 100vh;
      overflow-x: hidden;
    }

    #particle-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
    body.modal-open { overflow: hidden; }

    /* --- UI Components --- */
    .control-btn {
      background: var(--surface); border: 1px solid var(--border);
      width: 42px; height: 42px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text); font-size: 1.2rem;
      transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      backdrop-filter: blur(5px);
    }
    .control-btn:hover { transform: scale(1.1); color: var(--accent); border-color: var(--accent); }

    /* --- Login Bar (Compact) --- */
    #login-bar-container {
        display: flex; justify-content: center; margin-top: -1.5rem; margin-bottom: 2rem; position: relative; z-index: 20;
    }
    .login-compact-bar {
        background: var(--glass);
        backdrop-filter: blur(12px);
        border: 1px solid var(--border);
        padding: 0.5rem 0.8rem 0.5rem 1.5rem;
        border-radius: 50px;
        display: flex;
        align-items: center;
        gap: 1rem;
        box-shadow: var(--card-shadow);
        transition: transform 0.3s ease;
    }
    .login-compact-bar:hover { transform: translateY(-2px); border-color: var(--accent); }
    .login-text { font-size: 0.95rem; color: var(--text-light); font-weight: 500; }
    .login-action-btn {
        background: var(--accent); color: #fff; border: none;
        padding: 6px 20px; border-radius: 30px; font-size: 0.9rem; font-weight: bold;
        cursor: pointer; transition: all 0.2s;
    }
    .login-action-btn:hover { filter: brightness(1.1); transform: scale(1.05); }

    /* --- Login Modal --- */
    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
        z-index: 1000; display: none; align-items: center; justify-content: center;
        opacity: 0; transition: opacity 0.3s;
    }
    .modal-overlay.show { display: flex; opacity: 1; }
    .auth-box {
        background: var(--surface); border: 1px solid var(--border);
        padding: 2.5rem; border-radius: 16px; width: 90%; max-width: 400px;
        box-shadow: 0 20px 50px rgba(0,0,0,0.3); transform: translateY(20px); transition: transform 0.3s;
    }
    .modal-overlay.show .auth-box { transform: translateY(0); }
    .auth-title { font-family: 'Cinzel Decorative'; text-align: center; margin-bottom: 1.5rem; color: var(--accent); font-size: 1.5rem; }
    .google-btn {
        width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border);
        background: white; color: #333; font-weight: bold; cursor: pointer;
        display: flex; align-items: center; justify-content: center; gap: 10px;
        transition: 0.2s; margin-bottom: 1.5rem;
    }
    .google-btn:hover { background: #f1f1f1; }
    .divider { text-align: center; border-bottom: 1px solid var(--border); line-height: 0.1em; margin: 10px 0 20px; }
    .divider span { background: var(--surface); padding: 0 10px; color: var(--text-light); font-size: 0.8rem; }
    .input-group { margin-bottom: 1rem; }
    .input-group input {
        width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border);
        background: rgba(255,255,255,0.05); color: var(--text); outline: none;
    }
    .input-group input:focus { border-color: var(--accent); }
    .email-btn {
        width: 100%; padding: 10px; border-radius: 8px; border: none;
        background: var(--text); color: var(--surface); font-weight: bold; cursor: pointer;
    }
    .toggle-auth { text-align: center; margin-top: 1rem; font-size: 0.85rem; color: var(--text-light); cursor: pointer; text-decoration: underline; }

    /* --- Member Card (Galaxy Pass) --- */
    #member-terminal { max-width: 1000px; margin: 0 auto 3rem; position: relative; z-index: 20; display: none; }
    .member-dashboard {
        display: grid; grid-template-columns: 300px 1fr; gap: 1.5rem;
    }
    @media (max-width: 800px) { .member-dashboard { grid-template-columns: 1fr; } }

    /* Left Panel: Profile & Calendar */
    .profile-panel {
        background: var(--surface); border: 1px solid var(--border); border-radius: 16px;
        padding: 1.5rem; text-align: center; height: 100%;
        display: flex; flex-direction: column;
    }
    .streak-ring {
        width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--border);
        margin: 0 auto 1rem; display: flex; flex-direction: column; align-items: center; justify-content: center;
        border-top-color: var(--accent); border-right-color: var(--accent); transform: rotate(-45deg);
    }
    .streak-content { transform: rotate(45deg); text-align: center; }
    .streak-num { font-size: 2.5rem; font-weight: 700; color: var(--accent); line-height: 1; }
    .streak-label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; }
    
    .calendar-wrapper { margin-top: auto; }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; font-size: 0.8rem; margin: 1rem 0; }
    .cal-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: rgba(0,0,0,0.05); font-size: 0.75rem; }
    .cal-day.checked { background: var(--accent); color: #fff; }
    
    .checkin-btn {
        background: linear-gradient(135deg, var(--accent), #27ae60); color: white; border: none;
        width: 100%; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer;
        transition: transform 0.2s; margin-top: 1rem;
    }
    .checkin-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4); }
    .checkin-btn:disabled { background: var(--border); color: var(--text-light); cursor: not-allowed; transform: none; box-shadow: none; }

    /* Right Panel: Content Cards */
    .content-panel { display: flex; flex-direction: column; gap: 1.5rem; }
    
    .data-card {
        background: var(--surface); border: 1px solid var(--border); border-radius: 16px;
        padding: 1.5rem; position: relative; overflow: hidden;
        transition: transform 0.3s;
    }
    .data-card:hover { transform: translateY(-3px); border-color: var(--accent); }
    .card-label { 
        font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; color: var(--text-light); 
        margin-bottom: 1rem; display: block; border-bottom: 1px solid var(--border); padding-bottom: 5px;
    }

    /* Word Card Design */
    .word-card { border-left: 4px solid var(--planet-color); }
    .word-header { display: flex; align-items: baseline; gap: 10px; margin-bottom: 0.5rem; }
    .the-word { font-size: 2.2rem; font-weight: 800; color: var(--text); letter-spacing: -0.5px; }
    .the-ipa { font-family: 'Times New Roman', serif; font-style: italic; color: var(--text-light); }
    .the-pos { background: var(--planet-color); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; vertical-align: middle; }
    .the-meaning { font-size: 1.2rem; color: var(--accent); font-weight: 500; margin-bottom: 1rem; }
    .the-sentence { font-style: italic; color: var(--text-light); padding-left: 1rem; border-left: 2px solid var(--border); }

    /* Quote Card Design */
    .quote-card { border-left: 4px solid var(--sun-color); background: linear-gradient(to right, var(--surface), rgba(241, 196, 15, 0.05)); }
    .the-quote { font-family: 'Playfair Display', serif; font-size: 1.4rem; line-height: 1.4; color: var(--text); margin-bottom: 1rem; }
    .the-trans { font-size: 1rem; color: var(--text-light); margin-bottom: 1rem; }
    .the-author { text-align: right; font-weight: bold; color: var(--sun-color); font-family: 'Cinzel Decorative'; }

    /* Print Styles (Hidden by default) */
    .print-only { display: none; }
    @media print {
        body * { visibility: hidden; }
        #print-area, #print-area * { visibility: visible; }
        #print-area { position: absolute; left: 0; top: 0; width: 100%; padding: 40px; color: black; background: white; z-index: 9999; }
        .print-only { display: block; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #333; padding: 12px; text-align: left; vertical-align: top; }
        th { background: #f0f0f0; font-weight: bold; }
        .print-header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
    }

    /* General Layout */
    .top-bar { position: absolute; top: 1.5rem; right: 2rem; display: flex; gap: 1rem; z-index: 50; }
    header { display: flex; flex-direction: column; align-items: center; padding: 4rem 1rem 1rem; position: relative; z-index: 10; text-align: center; }
    .title-container { position: relative; width: 100%; max-width: 800px; height: 180px; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    .main-title { font-family: 'Cinzel Decorative', cursive; font-size: clamp(1.7rem, 5.5vw, 4rem); font-weight: 700; color: var(--text); line-height: 1.1; text-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .dark .main-title { color: #ffffff; text-shadow: 0 0 15px rgba(241, 196, 15, 0.5); }
    .title-underline { width: 60%; height: 2px; background: linear-gradient(90deg, transparent, var(--accent), transparent); margin-top: 10px; }
    
    /* Letter Modal */
    .letter-content { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); background: var(--surface); backdrop-filter: blur(20px); border: 1px solid var(--border); border-radius: 12px; padding: 3rem; max-width: 700px; width: 90%; box-shadow: 0 25px 50px rgba(0,0,0,0.3); z-index: 1000; opacity: 0; pointer-events: none; transition: all 0.4s; color: var(--text); max-height: 85vh; overflow-y: auto; }
    .letter-content.show { opacity: 1; pointer-events: auto; transform: translate(-50%, -50%) scale(1); }
    .letter-title { font-family: 'Cinzel Decorative'; font-size: 1.6rem; color: var(--accent); border-bottom: 1px solid var(--border); padding-bottom: 1rem; margin-bottom: 1.5rem; }

    /* Categories */
    .categories { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; padding: 1rem 2rem 4rem; max-width: 1000px; margin: 0 auto; position: relative; z-index: 5; }
    .category-card { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 2rem; text-align: center; text-decoration: none; color: var(--text); transition: all 0.3s ease; box-shadow: var(--card-shadow); display: flex; flex-direction: column; align-items: center; }
    .category-card:hover { transform: translateY(-5px); border-color: var(--accent); }
    .icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
    .page-footer { border-top: 1px solid var(--border); padding: 2rem; text-align: center; font-size: 0.9rem; color: var(--text-light); background: rgba(0,0,0,0.02); }
    
    @media (max-width: 768px) { .categories { grid-template-columns: 1fr; } header { padding-top: 6rem; } }
  </style>
</head>
<body>

  <canvas id="particle-canvas"></canvas>

  <div class="top-bar">
      <div id="openLetter" class="control-btn" title="A Message from Shirley">ğŸ“©</div>
      <div id="themeToggle" class="control-btn" title="Toggle Theme">ğŸŒ“</div>
      <div id="musicToggle" class="control-btn" title="Play Music">ğŸµ</div>
  </div>

  <header>
    <div class="title-container">
        <h1 class="main-title">Teacher Shirleyâ€™s<br>ET Platform</h1>
        <div class="title-underline"></div>
        <div style="margin-top:5px; color:var(--accent); font-family:'Exo 2'; letter-spacing:2px; font-size:0.9rem;">(ET means English Teaching)</div>
    </div>
  </header>

  <audio id="chimeSound" src="https://ducj-creator.github.io/Teacher-Shirley/assets/windchime.mp3" preload="auto"></audio>
  <audio id="themeSong" src="https://ducj-creator.github.io/Teacher-Shirley/assets/theme%20song.mp3" preload="auto"></audio>

  <div class="letter-content" id="letterContent">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <div class="letter-title">A Message from Shirley</div>
        <button class="control-btn" style="width:30px; height:30px; border:none;" id="closeLetter">Ã—</button>
    </div>
    <div style="line-height:1.8; font-size:1.05rem;">
        <p><strong>Hi there! ğŸ‘‹</strong></p>
        <p>Iâ€™m Shirleyâ€”an English teacher who believes learning should be joyful, interactive, and full of â€œaha!â€ moments.</p>
        <p>This website is your free, ad-free teaching and learning toolkitâ€”crafted from real classroom experience.</p>
        <p>Everyone can use all tools and content freely.</p>
        <p style="background:var(--bg-gradient); padding:10px; border-left:3px solid var(--accent); margin:10px 0;">
            But if you <strong>log in</strong>, youâ€™ll unlock:<br>
            âœ¨ Daily vocabulary<br>
            âœ¨ Daily bilingual (Chinese-English) quotes<br>
            âœ¨ A personal learning log to track your progress
        </p>
        <p>I highly encourage students to check in every dayâ€”consistency turns small efforts into big results!</p>
        <p>Letâ€™s make language learning lively, meaningful, and a little bit magical. ğŸ’«</p>
        <hr style="margin:20px 0; border:0; border-top:1px dashed var(--border);">
        <p><strong>Shirley Duè€å¸« çš„ä¸€å°ä¿¡</strong></p>
        <p>å¤§å®¶å¥½ï¼ğŸ‘‹ æˆ‘æ˜¯ Shirley Duâ€”â€”ä¸€å€‹ç›¸ä¿¡å­¸ç¿’æ‡‰è©²å……æ»¿æ¨‚è¶£ã€äº’å‹•ï¼Œä¸¦æ™‚å¸¸è¿¸ç™¼ã€Œå•Šå“ˆï¼ã€éˆæ„Ÿçš„è‹±æ–‡è€å¸«ã€‚</p>
        <p>é€™å€‹ç¶²ç«™æ˜¯ä½ å…è²»ã€ç„¡å»£çš„æ•™å­¸èˆ‡å­¸ç¿’å·¥å…·ç®±â€”â€”æºè‡ªçœŸå¯¦èª²å ‚ç¶“é©—èˆ‡å­¸ç”Ÿå›é¥‹ã€‚ä»»ä½•äººéƒ½å¯è‡ªç”±ä½¿ç”¨æ‰€æœ‰å·¥å…·èˆ‡å…§å®¹ã€‚</p>
        <p>ä½†å¦‚æœä½  <strong>ç™»å…¥å¸³æˆ¶</strong>ï¼Œé‚„èƒ½ç²å¾—ï¼š<br>âœ¨ æ¯æ—¥å–®å­—<br>âœ¨ æ¯æ—¥ä¸­è‹±ä½³å¥<br>âœ¨ å€‹äººå­¸ç¿’æ­·ç¨‹æ‰“å¡è¨˜éŒ„</p>
        <p>æˆ‘å¼·çƒˆæ¨è–¦åŒå­¸å€‘æ¯å¤©æ‰“å¡å­¸ç¿’â€”â€”æŒä¹‹ä»¥æ†ï¼Œå¾®å°çš„ç´¯ç©çµ‚å°‡å¸¶ä¾†é©šäººçš„æˆé•·ï¼</p>
        <p>è®“æˆ‘å€‘ä¸€èµ·æŠŠèªè¨€å­¸ç¿’è®Šå¾—ç”Ÿå‹•ã€æœ‰æ„ç¾©ï¼Œè€Œä¸”å¸¶é»é­”æ³•å§ï¼ğŸ’«</p>
        <p style="text-align:right; margin-top:1rem; color:var(--accent); font-family:'Cinzel Decorative';">â€” Teacher Shirley</p>
    </div>
  </div>

  <div id="login-bar-container">
      <div class="login-compact-bar" id="login-trigger">
          <span class="login-text">Track your journey? ç´€éŒ„å­¸ç¿’æ­·ç¨‹</span>
          <button class="login-action-btn">Log In / ç™»å…¥</button>
      </div>
  </div>

  <div class="modal-overlay" id="auth-modal">
      <div class="auth-box">
          <div style="text-align:right;"><span style="cursor:pointer;" onclick="closeAuthModal()">âœ•</span></div>
          <h3 class="auth-title">Student Access</h3>
          
          <button id="google-login-btn" class="google-btn">
              <svg width="18" height="18" viewBox="0 0 18 18"><path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/><path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.715H.957v2.332A8.997 8.997 0 0 0 9 18z"/><path fill="#FBBC05" d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z"/><path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 7.29C4.672 5.159 6.656 3.58 9 3.58z"/></svg>
              Continue with Google
          </button>

          <div class="divider"><span>OR</span></div>

          <div id="email-form">
              <div class="input-group">
                  <input type="email" id="email-input" placeholder="Email address">
              </div>
              <div class="input-group">
                  <input type="password" id="pass-input" placeholder="Password">
              </div>
              <button class="email-btn" id="email-login-btn">Sign In with Email</button>
              <div class="toggle-auth" id="toggle-signup">New here? Create an account</div>
          </div>
      </div>
  </div>

  <div id="member-terminal">
      <div class="member-dashboard">
          <div class="profile-panel">
              <h3 id="greeting-name" style="font-family:'Cinzel Decorative'; color:var(--text); margin-bottom:1rem;">Welcome</h3>
              
              <div class="streak-ring">
                  <div class="streak-content">
                      <div class="streak-num" id="streak-days">0</div>
                      <div class="streak-label">Day Streak</div>
                  </div>
              </div>
              
              <div style="font-size:0.85rem; color:var(--text-light); margin-bottom:1rem;">
                  Total Check-ins: <strong id="total-days" style="color:var(--text)">0</strong>
              </div>

              <div class="calendar-wrapper">
                  <div id="current-month-display" style="font-weight:bold; margin-bottom:5px;">Calendar</div>
                  <div class="calendar-grid" id="calendar-grid"></div>
                  <button id="checkin-btn" class="checkin-btn" onclick="handleCheckIn()">Sign In Today</button>
                  <p id="checkin-msg" style="margin-top:5px; font-size:0.8rem; height:1.2em;"></p>
              </div>
              
              <div style="margin-top:1rem; display:flex; justify-content:space-between; font-size:0.8rem;">
                  <span style="cursor:pointer; text-decoration:underline;" onclick="printRecords()">ğŸ–¨ï¸ Print Records</span>
                  <span style="cursor:pointer; opacity:0.7;" onclick="handleLogout()">Logout</span>
              </div>
          </div>

          <div class="content-panel">
              <div class="data-card word-card">
                  <span class="card-label">Word of the Day <span id="word-date"></span></span>
                  <div class="word-header">
                      <span class="the-word" id="wotd-word">Loading...</span>
                      <span class="the-pos" id="wotd-pos"></span>
                  </div>
                  <div class="the-ipa" id="wotd-ipa"></div>
                  <div class="the-meaning" id="wotd-meaning"></div>
                  <div class="the-sentence">
                      <div id="wotd-sentence-e"></div>
                      <div id="wotd-sentence-c" style="font-size:0.9rem; opacity:0.8; margin-top:3px;"></div>
                  </div>
              </div>

              <div class="data-card quote-card">
                  <span class="card-label">Quote of the Day</span>
                  <div class="the-quote" id="qotd-text"></div>
                  <div class="the-trans" id="qotd-trans"></div>
                  <div class="the-author" id="qotd-author"></div>
              </div>
          </div>
      </div>
  </div>

  <div id="print-area" class="print-only">
      <div class="print-header">
          <h1>My Learning Journey</h1>
          <p>Student: <span id="print-name"></span> | Date: <span id="print-date"></span></p>
          <p>Teacher Shirley's English Platform</p>
      </div>
      <table id="print-table">
          <thead>
              <tr>
                  <th style="width:15%">Date</th>
                  <th style="width:25%">Word</th>
                  <th style="width:30%">Meaning / Example</th>
                  <th style="width:30%">Quote</th>
              </tr>
          </thead>
          <tbody id="print-body"></tbody>
      </table>
  </div>

  <div class="categories">
    <a href="/Teacher-Shirley/teaching-tools/" class="category-card">
      <span class="icon">ğŸš€</span>
      <h2>Teaching Tools for Teachers</h2>
      <div class="subtitle">å¸«å¸«ç™¾å¯¶ç®±</div>
    </a>
    <a href="https://ducj-creator.github.io/Teacher-Shirley/study-tools/index.html" class="category-card">
      <span class="icon">ğŸª</span>
      <h2>Study Tools for Students</h2>
      <div class="subtitle">å­¸å­¸æ™ºè¶£é–£</div>
    </a>
    <a href="/Teacher-Shirley/amusement-park/" class="category-card">
      <span class="icon">ğŸ›¸</span>
      <h2>Amusement Park</h2>
      <div class="subtitle">æ¨‚æ¨‚å¬‰éŠè°·</div>
    </a>
    <a href="/Teacher-Shirley/external-resources/" class="category-card">
      <span class="icon">ğŸŒŒ</span>
      <h2>External Resources</h2>
      <div class="subtitle">æºæºé€£çµåº«</div>
    </a>
  </div>
  
  <footer class="page-footer">
    <div>Â©ï¸ Shirleyâ€˜s ET Platform; Since 2025; All Rights Reserved</div>
    <span id="busuanzi_container_site_pv">Total Visits <span id="busuanzi_value_site_pv"></span></span>
    <div style="margin-top:0.4rem;">
      Signal Frequency: <a href="https://forms.gle/EW62xKbBjHaLpBUy9" target="_blank">Contact Teacher Shirley</a>
    </div>
  </footer>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

    // æ‚¨çš„ Config
    const firebaseConfig = {
      apiKey: "AIzaSyCta1_RddjhYBA437cl8Wg1kGW_bsVimK8",
      authDomain: "teacher-shirley.firebaseapp.com",
      databaseURL: "https://teacher-shirley-default-rtdb.firebaseio.com",
      projectId: "teacher-shirley",
      storageBucket: "teacher-shirley.firebasestorage.app",
      messagingSenderId: "534843195436",
      appId: "1:534843195436:web:f1f873e6f6e8c257ce9189"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    let currentUser = null;
    let csvData = { words: [], quotes: [] };
    let checkinHistory = []; 

    // UI Logic: Modal
    const loginTrigger = document.getElementById('login-trigger');
    const authModal = document.getElementById('auth-modal');
    loginTrigger.addEventListener('click', () => authModal.classList.add('show'));
    window.closeAuthModal = () => authModal.classList.remove('show');
    
    // Toggle Sign In / Sign Up Text
    let isSignUp = false;
    const toggleSignup = document.getElementById('toggle-signup');
    const emailBtn = document.getElementById('email-login-btn');
    toggleSignup.addEventListener('click', () => {
        isSignUp = !isSignUp;
        emailBtn.innerText = isSignUp ? "Create Account" : "Sign In with Email";
        toggleSignup.innerText = isSignUp ? "Already have an account? Sign In" : "New here? Create an account";
    });

    // CSV Parser
    function parseCSV(text) {
        const lines = text.trim().split('\n');
        const headers = lines[0].split(',').map(h => h.trim());
        return lines.slice(1).map(line => {
            const regex = /(?:,|\n|^)("(?:(?:"")*[^"]*)*"|[^",\n]*|(?:\n|$))/g;
            const matches = [];
            let match;
            while ((match = regex.exec(line)) !== null) {
                 if (match.index === regex.lastIndex) regex.lastIndex++; 
                 if (match[1] !== undefined) matches.push(match[1].replace(/^"|"$/g, '').replace(/""/g, '"'));
            }
            const row = {};
            headers.forEach((h, i) => row[h] = matches[i] ? matches[i].trim() : '');
            return row;
        });
    }

    async function loadCSVData() {
        try {
            const [resWords, resQuotes] = await Promise.all([
                fetch('https://ducj-creator.github.io/Teacher-Shirley/assets/word%20of%20the%20day.csv'),
                fetch('https://ducj-creator.github.io/Teacher-Shirley/assets/quote%20of%20the%20day.csv')
            ]);
            csvData.words = parseCSV(await resWords.text());
            csvData.quotes = parseCSV(await resQuotes.text());
        } catch (e) { console.error("CSV error", e); }
    }

    function getTodayMMDD() {
        const now = new Date();
        return String(now.getMonth() + 1).padStart(2, '0') + '-' + String(now.getDate()).padStart(2, '0');
    }

    function renderDailyContent(dateStr) {
        const wordObj = csvData.words.find(r => r.date === dateStr);
        if (wordObj) {
            document.getElementById('wotd-word').innerText = wordObj.word;
            document.getElementById('wotd-ipa').innerText = wordObj.ipa;
            document.getElementById('wotd-pos').innerText = wordObj.pos;
            document.getElementById('wotd-meaning').innerText = wordObj.meaning;
            document.getElementById('wotd-sentence-e').innerText = wordObj['sentence e'];
            document.getElementById('wotd-sentence-c').innerText = wordObj['sentence c'];
            document.getElementById('word-date').innerText = `(${dateStr})`;
        } else {
            document.getElementById('wotd-word').innerText = "Rest Day";
            document.getElementById('wotd-meaning').innerText = "Enjoy your break!";
        }

        const quoteObj = csvData.quotes.find(r => r.date === dateStr);
        if (quoteObj) {
            document.getElementById('qotd-text').innerText = quoteObj['quote e'];
            document.getElementById('qotd-trans').innerText = quoteObj['quote c'];
            document.getElementById('qotd-author').innerText = "â€” " + quoteObj.author;
        }
    }

    // Login Logic
    document.getElementById('google-login-btn').addEventListener('click', () => {
        signInWithPopup(auth, provider).catch(e => alert(e.message));
    });

    document.getElementById('email-login-btn').addEventListener('click', () => {
        const email = document.getElementById('email-input').value;
        const pass = document.getElementById('pass-input').value;
        if (!email || !pass) return alert("Please fill in fields");
        
        if (isSignUp) {
            createUserWithEmailAndPassword(auth, email, pass).catch(e => alert(e.message));
        } else {
            signInWithEmailAndPassword(auth, email, pass).catch(e => alert(e.message));
        }
    });

    window.handleLogout = () => {
        signOut(auth).then(() => location.reload());
    };

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            document.getElementById('login-bar-container').style.display = 'none';
            document.getElementById('auth-modal').classList.remove('show');
            document.getElementById('member-terminal').style.display = 'block';
            document.getElementById('greeting-name').innerText = `Hi, ${user.displayName || user.email.split('@')[0]}`;
            
            await loadCSVData();
            await loadUserData(user.uid);
            renderDailyContent(getTodayMMDD());
        } else {
            document.getElementById('login-bar-container').style.display = 'flex';
            document.getElementById('member-terminal').style.display = 'none';
        }
    });

    async function loadUserData(uid) {
        const userRef = doc(db, "users", uid);
        const docSnap = await getDoc(userRef);
        const fullDate = new Date().toISOString().split('T')[0];

        if (docSnap.exists()) {
            const data = docSnap.data();
            checkinHistory = data.history || [];
            document.getElementById('total-days').innerText = checkinHistory.length;
            document.getElementById('streak-days').innerText = data.streak || 0;
            if (checkinHistory.includes(fullDate)) disableCheckInBtn("Checked in! âœ…");
        } else {
            checkinHistory = [];
        }
        renderCalendar();
    }

    window.handleCheckIn = async () => {
        if (!currentUser) return;
        const btn = document.getElementById('checkin-btn');
        btn.disabled = true; btn.innerText = "Signing in...";

        const fullDate = new Date().toISOString().split('T')[0];
        const userRef = doc(db, "users", currentUser.uid);
        
        try {
            const docSnap = await getDoc(userRef);
            let currentStreak = 0;
            let lastCheckIn = null;
            if (docSnap.exists()) {
                const data = docSnap.data();
                currentStreak = data.streak || 0;
                const history = data.history || [];
                if (history.length > 0) lastCheckIn = history[history.length - 1];
            }

            const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toISOString().split('T')[0];
            if (lastCheckIn === yesterdayStr) currentStreak++;
            else if (lastCheckIn !== fullDate) currentStreak = 1;

            const newHistory = checkinHistory.includes(fullDate) ? checkinHistory : [...checkinHistory, fullDate];
            await setDoc(userRef, {
                email: currentUser.email,
                name: currentUser.displayName || currentUser.email,
                streak: currentStreak,
                lastUpdate: fullDate,
                history: newHistory
            }, { merge: true });

            checkinHistory = newHistory;
            document.getElementById('streak-days').innerText = currentStreak;
            document.getElementById('total-days').innerText = checkinHistory.length;
            disableCheckInBtn("Success! ğŸ‰");
            renderCalendar();
        } catch (e) {
            console.error(e); btn.disabled = false; btn.innerText = "Try Again";
        }
    };

    function disableCheckInBtn(msg) {
        const btn = document.getElementById('checkin-btn');
        btn.disabled = true; btn.innerText = msg;
    }

    function renderCalendar() {
        const grid = document.getElementById('calendar-grid');
        grid.innerHTML = '';
        const now = new Date();
        const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        document.getElementById('current-month-display').innerText = `${monthNames[now.getMonth()]} ${now.getFullYear()}`;
        
        const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
        const currentYearMonth = now.toISOString().slice(0, 7); 
        
        for (let i = 1; i <= daysInMonth; i++) {
            const dayEl = document.createElement('div');
            dayEl.className = 'cal-day';
            dayEl.innerText = i;
            const dateStr = `${currentYearMonth}-${String(i).padStart(2, '0')}`;
            if (checkinHistory.includes(dateStr)) dayEl.classList.add('checked');
            grid.appendChild(dayEl);
        }
    }

    window.printRecords = () => {
        if (!currentUser) return;
        const printBody = document.getElementById('print-body');
        printBody.innerHTML = '';
        document.getElementById('print-name').innerText = currentUser.displayName || currentUser.email;
        document.getElementById('print-date').innerText = new Date().toLocaleDateString();

        checkinHistory.sort().forEach(dateStr => { 
            const mmdd = dateStr.slice(5);
            const wordObj = csvData.words.find(r => r.date === mmdd) || {};
            const quoteObj = csvData.quotes.find(r => r.date === mmdd) || {};
            
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${dateStr}</td>
                <td><strong>${wordObj.word || '-'}</strong><br><small>${wordObj.ipa||''}</small></td>
                <td><strong style="color:#2980b9">${wordObj.meaning||''}</strong><br><em>${wordObj['sentence e']||''}</em></td>
                <td><em>"${quoteObj['quote e']||'-'}"</em><br><small>${quoteObj['quote c']||''}</small></td>
            `;
            printBody.appendChild(tr);
        });
        window.print();
    };

    // Particles & Theme (Preserved)
    const canvas = document.getElementById('particle-canvas');
    const ctx = canvas.getContext('2d');
    let particlesArray;
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; initParticles(); });
    class Particle {
        constructor() { this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.size = Math.random() * 2; this.speedX = (Math.random() * 0.4 - 0.2); this.speedY = (Math.random() * 0.4 - 0.2); this.opacity = Math.random(); }
        update() { this.x += this.speedX; this.y += this.speedY; if(this.x>canvas.width)this.x=0; if(this.x<0)this.x=canvas.width; if(this.y>canvas.height)this.y=0; if(this.y<0)this.y=canvas.height; }
        draw(isDark) { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fillStyle = isDark ? `rgba(241, 196, 15, ${this.opacity})` : `rgba(44, 62, 80, ${this.opacity * 0.3})`; ctx.fill(); }
    }
    function initParticles() { particlesArray = []; for (let i = 0; i < (canvas.width * canvas.height)/12000; i++) particlesArray.push(new Particle()); }
    function animateParticles() {
        requestAnimationFrame(animateParticles); ctx.clearRect(0, 0, canvas.width, canvas.height);
        const isDark = document.getElementById('htmlRoot').classList.contains('dark');
        for (let i = 0; i < particlesArray.length; i++) { particlesArray[i].update(); particlesArray[i].draw(isDark); }
    }
    initParticles(); animateParticles();

    const html = document.getElementById('htmlRoot');
    const toggleBtn = document.getElementById('themeToggle');
    toggleBtn.addEventListener('click', () => { html.classList.toggle('dark'); });

    // Letter
    const openLetter = document.getElementById('openLetter');
    const letterContent = document.getElementById('letterContent');
    const closeLetter = document.getElementById('closeLetter');
    openLetter.addEventListener('click', () => { letterContent.classList.add('show'); document.body.classList.add('modal-open'); });
    closeLetter.addEventListener('click', () => { letterContent.classList.remove('show'); document.body.classList.remove('modal-open'); });
    
    // Music
    const musicToggle = document.getElementById('musicToggle');
    const themeSong = document.getElementById('themeSong');
    let isPlaying = false;
    musicToggle.addEventListener('click', () => {
        if(isPlaying) { themeSong.pause(); musicToggle.style.color="var(--text)"; }
        else { themeSong.currentTime=0; themeSong.play(); musicToggle.style.color="var(--accent)"; }
        isPlaying = !isPlaying;
    });
  </script>
</body>
</html>
